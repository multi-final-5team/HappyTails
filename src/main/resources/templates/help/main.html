<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head">

    <meta charset="UTF-8">
    <title>ê³ ê°ì„¼í„°</title>
</head>
<body>
<menu th:replace="fragments/head :: menu"></menu>
    <main>
        <div class="container">
            <h1 class="mb-4 text-center">ğŸ¾ ê³ ê°ì„¼í„° ğŸ¾</h1>
            <h3 class="mb-4 text-center">ê³ ë¯¼ ìˆìœ¼ë©´ ì—¬ê¸°ë‹¤ ì–˜ê¸°í•˜ê°œ ğŸ¶</h3>
            <div class="btn-group" id="categoryTag">
            </div>
            <table class="table table-hover">
                <tbody id="questionTbody">

                </tbody>
            </table>
            <!-- ë¡œê·¸ì¸ í•œ ì¼ë°˜ ìœ ì €ë§Œ ì ‘ê·¼ ê°€ëŠ¥ (í›„ ifë¬¸ ì¶”ê°€)-->
                <button type="button" id="inquiryWriteGo" class="btn btn-outline-info">ë¬¸ì˜ í•˜ê¸°</button>
                <button type="button" id="inquiryListGo" class="btn btn-outline-info">ì´ì „ ë‚´ ë¬¸ì˜ ë³´ê¸°</button>
            <!-- ë¡œê·¸ì¸ í•œ ì¼ë°˜ ìœ ì €ë§Œ ì ‘ê·¼ ê°€ëŠ¥ -->

        </div>


    </main>

<!-- ìŠ¤í¬ë¦½íŠ¸ ë¶€ë¶„ -->
<script src="/js/help/function.js"></script>
<script>
    $(document).ready(function() {
        console.log('ì‹¤í–‰');
        // ìì£¼ë¬»ëŠ”ì§ˆë¬¸ list
        getQuestionList();
        //

        // ì¹´í…Œê³ ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸° Start
        $.ajax({
            type: "GET",
            url: "/help/getCategory",
            dataType: "json",
            success: function (result) {
                for (var i = 0; i < result.length; i++) {
                    let htmlStr = `
                            <button type="button" class="btn btn-outline-primary categoryBtns"value='` + result[i].helpCategoryCode + `'>` + result[i].categoryName + `</button>
                        `;
                    $('#categoryTag').append(htmlStr);
                }
            }
        });
        // ì¹´í…Œê³ ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸° End
        // ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ List function Start
        function getQuestionList(categoryCode) {
            $('#questionTbody').html('');
            $.ajax({
                type : "GET",
                url : "/help/question/list",
                dataType : "json",
                data : {categoryCode : categoryCode},
                success : function(result) {
                    for (var i = 0 ; i < result.length; i++) {
                        let htmlStr = `
                                <tr>
                                    <td class="questionTds" data-answer="` + result[i].answerContent + `">Q.` + result[i].questionContent + `</td>
                                </tr>
                            `;
                        $('#questionTbody').append(htmlStr);
                    }
                }
            });
        }
        // ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ List function End

        // categoryButton í´ë¦­ ì‹œ ë¦¬ìŠ¤íŠ¸ ë³€ê²½ Start
        $(document).on('click', '.categoryBtns', function() {
            let btnValue = $(this).val();
            getQuestionList(btnValue);
        });
        // categoryButton í´ë¦­ ì‹œ ë¦¬ìŠ¤íŠ¸ ë³€ê²½ End
        // question ë¦¬ìŠ¤íŠ¸ í´ë¦­ ì‹œ ìƒì„¸ ë‚´ìš© ë³´ê¸° Start
        $(document).on('click', '.questionTds', function() {
            $('.answerTable').remove('');
            let answer = $(this).data('answer');
            let htmlStr = `
                <td colspan="1" class="answerTable">
                   <table class="table mb-0 ">
                     <td>`+answer+`</td>
                   </table>
                </td>
            `;
            $(this).append(htmlStr);
        });
        // question ë¦¬ìŠ¤íŠ¸ í´ë¦­ ì‹œ ìƒì„¸ ë‚´ìš© ë³´ê¸° End
        // Button Page ì´ë™ Start
        $('#inquiryWriteGo').click(function(){
            location.href = '/help/inquiry/write';
        });
        $('#inquiryListGo').click(function(){
            location.href = '/help/inquiry/list';
        });
        // Button Page ì´ë™ End
    });
</script>
</body>
</html>